"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2388],{7055:(f,d,i)=>{i.d(d,{g:()=>a});const a=(0,i(2726).fo)("App",{web:()=>i.e(2912).then(i.bind(i,2912)).then(s=>new s.AppWeb)})},2388:(f,d,i)=>{i.r(d),i.d(d,{CheckoutPageModule:()=>L});var r=i(6814),a=i(95),s=i(5548),g=i(3057),b=i(5861),_=i(7055),p=i(7394),t=i(6689),C=i(4695),y=i(2425),P=i(5821),M=i(7535);function O(e,c){1&e&&(t.TgZ(0,"span",20),t._uU(1,"Discount can not be more then amount"),t.qZA())}function x(e,c){if(1&e&&(t.TgZ(0,"div",21)(1,"label"),t._uU(2,"Total"),t.qZA(),t.TgZ(3,"h2"),t._uU(4),t.ALo(5,"number"),t.TgZ(6,"span"),t._uU(7,"frs"),t.qZA()()()),2&e){const o=t.oxw();t.xp6(4),t.hij("",t.lcZ(5,1,o.cartSummary.totalAmount-o.discount)," ")}}function k(e,c){1&e&&(t.TgZ(0,"div",21)(1,"label"),t._uU(2,"Total"),t.qZA(),t.TgZ(3,"h2"),t._uU(4),t.ALo(5,"number"),t.TgZ(6,"span"),t._uU(7,"frs"),t.qZA()()()),2&e&&(t.xp6(4),t.hij("",t.lcZ(5,1,0)," "))}function v(e,c){1&e&&(t.TgZ(0,"i"),t._UZ(1,"img",26),t.qZA())}function w(e,c){1&e&&(t.TgZ(0,"i"),t._UZ(1,"img",27),t.qZA())}function A(e,c){1&e&&(t.TgZ(0,"i"),t._UZ(1,"img",28),t.qZA())}function Z(e,c){if(1&e&&t._UZ(0,"input",29),2&e){const o=t.oxw().$implicit;t.s9C("placeholder",o.placeholder)}}const T=function(e){return{active:e}};function R(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"li",22),t.NdJ("click",function(){const u=t.CHM(o).$implicit,m=t.oxw();return t.KtG(m.selectMethod(u))}),t.TgZ(1,"strong")(2,"label"),t.YNc(3,v,2,0,"i",19),t.YNc(4,w,2,0,"i",19),t.YNc(5,A,2,0,"i",19),t._uU(6),t.qZA(),t.TgZ(7,"span",23),t._UZ(8,"span",24),t.qZA()(),t.YNc(9,Z,1,1,"input",25),t.qZA()}if(2&e){const o=c.$implicit;t.Q6J("ngClass",t.VKq(6,T,o.isSelected)),t.xp6(3),t.Q6J("ngIf","CASH"===o.title),t.xp6(1),t.Q6J("ngIf","MOMO"===o.title),t.xp6(1),t.Q6J("ngIf","BALAANZ ACCOUNT"===o.title),t.xp6(1),t.hij(" ",o.title," "),t.xp6(3),t.Q6J("ngIf",o.userInput&&o.isSelected)}}function S(e,c){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.BQk()),2&e){const o=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,o.cartSummary.totalAmount-o.discount)," frs ")}}function F(e,c){1&e&&(t.ynx(0),t._uU(1," 0 frs "),t.BQk())}const U=function(e){return{"error-field":e}},I=function(e){return{disabled:e}},N=[{path:"",component:(()=>{class e{constructor(o,n,l,u,m,z,V,Y,B){this._nav=o,this._user=n,this._toastr=l,this._global=u,this._platform=m,this._route=z,this._account=V,this._fb=Y,this.alertController=B,this.userDetails=null,this.cartList=[],this.runTimeProps=null,this.cartSummary={},this.apiSubscription=new p.w0,this.paymentSelected=null,this.discount=0,this.statusMaxCycle=3,this.statusCycle=0,this.isPaymentTimeout=!1,this.paymentRequest=null,this.paymentMethods=[{title:"CASH",id:1,userInput:!1,isSelected:!1,placeholder:null,navVal:"CASH"},{title:"MOMO",id:2,userInput:!0,isSelected:!1,placeholder:"Enter MOMO Number",navVal:"MOMO"},{title:"BALAANZ ACCOUNT",id:3,userInput:!0,isSelected:!1,placeholder:"Enter Account Number",navVal:"ACCOUNT"}],this.paymentForm=new a.cw({}),this._platform.backButton.subscribeWithPriority(-1,()=>{this._route.url&&this._route.url.search("dashboard")>0&&localStorage.getItem("token")&&_.g.exitApp()}),this._account.userDetailsObservable.subscribe(h=>{this.userDetails=h,console.log(this.userDetails),this._global.initCart(this.userDetails.id),this.cartList=this._global.retriveCart(this.userDetails.id).list,this.cartSummary=this._global.getCartSummary(),this.checkCart()}),this._account.runTimePropObservable.subscribe(h=>{this.runTimeProps=h})}ngOnInit(){this.generateForm()}checkCart(){setTimeout(()=>{this.cartList.length||this._nav.navigateBack("dashboard")},1e3)}updateDiscount(){var o=this;return(0,b.Z)(function*(){o.discount<0&&(o.discount=0,yield(yield o.alertController.create({header:"Invalid Discount",message:"Negative Discount Not Allowed",buttons:["OK"]})).present()),o.paymentForm.get("discount").setValue(o.discount)})()}ionViewWillEnter(){this._global.setServerErr(!1),this.apiSubscription=new p.w0,this.generateForm(),this.userDetails.id&&(this.cartList=this._global.retriveCart(this.userDetails.id).list,this.cartSummary=this._global.getCartSummary(),this.checkCart())}ionViewWillLeave(){this.apiSubscription.unsubscribe(),this._global.setServerErr(!1)}generateForm(){this.paymentForm=this._fb.group({method:["",[a.kI.required]],value:["",[]],discount:[0,[]]}),this.validateForm()}back(){this._global.setServerErr(!1),this._nav.back()}selectMethod(o){this.paymentMethods.forEach(n=>{n.isSelected=!1}),this.paymentSelected=o,o.isSelected=!0,this.validateForm()}validateForm(){this.paymentSelected&&(this.paymentForm.get("method").setValue(this.paymentSelected.navVal),this.paymentForm.get("value").setValue("")),"MOMO"===this.paymentForm.get("method").value||"ACCOUNT"===this.paymentForm.get("method").value?(this.paymentForm.get("value").setValidators([a.kI.required,a.kI.pattern(/^\d{9}$/)]),this.paymentForm.get("value").updateValueAndValidity()):(this.paymentForm.get("method"),this.paymentForm.get("value").setValidators(null),this.paymentForm.get("value").updateValueAndValidity())}processPayment(){if(console.log(this.paymentForm.value),this.discount>this.cartSummary.totalAmount)return;const o={mode:{type:this.paymentForm.value.method,identifier:this.paymentForm.value.value},discount:this.discount,cartContent:{}};this.cartList.forEach(n=>{o.cartContent[n.id]={productId:n.id,productName:n.name,quantity:n.quantity,productPrice:n.unitPrice}}),this._global.setLoader(!0),this._user.pay(o).subscribe(n=>{"CASH"!==this.paymentForm.value.method?(this._global.setLoader(!1),this._global.setPaymentData(this.paymentForm.value),this._nav.navigateForward("paymentStatus/"+n.requestId)):(this._global.setLoader(!1),this._global.setPaymentData(this.paymentForm.value),this._nav.navigateForward("receipt/0"))},n=>{this._global.setLoader(!1),this._toastr.error("Invalid Session","Authorization!"),this._account.logout()})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(s.SH),t.Y36(C.K),t.Y36(y._W),t.Y36(P.U),t.Y36(s.t4),t.Y36(g.F0),t.Y36(M.B),t.Y36(a.qu),t.Y36(s.Br))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-checkout"]],decls:38,vars:15,consts:[[1,"checkout-screen"],[1,"checkout-container"],[1,"app-header"],[1,"back-page",3,"click"],[1,"material-symbols-outlined"],[1,"app-page-title"],[1,"checkout-body"],[1,"checkout-summery"],[1,"checkout-summery-item","half-width"],[1,"checkout-discount"],["type","number","placeholder","Enter Discount",1,"form-field",3,"ngClass","ngModel","input","ngModelChange"],["class","error-highlight",4,"ngIf"],["class","checkout-summery-item align-center",4,"ngIf"],[1,"payment-method-block"],[3,"formGroup"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"checkout-bottom"],[1,"checkout-btn",3,"ngClass","click"],[1,"checkout-btn-right"],[4,"ngIf"],[1,"error-highlight"],[1,"checkout-summery-item","align-center"],[3,"ngClass","click"],[1,"radio-symbol"],[1,"radio-symbol-inner"],["type","text","class","form-field","formControlName","value",3,"placeholder",4,"ngIf"],["src","/assets/images/coin.png"],["src","/assets/images/mtn.png"],["src","/assets/images/account.png"],["type","text","formControlName","value",1,"form-field",3,"placeholder"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.NdJ("click",function(){return n.back()}),t.TgZ(4,"span",4),t._uU(5," arrow_back "),t.qZA()(),t.TgZ(6,"div",5),t._uU(7," My Checkout "),t.qZA()(),t.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"label"),t._uU(12,"Subtotal:"),t.qZA(),t.TgZ(13,"span"),t._uU(14),t.qZA()(),t.TgZ(15,"div",8)(16,"label"),t._uU(17,"Discount (-) :"),t.qZA(),t.TgZ(18,"div",9)(19,"input",10),t.NdJ("input",function(){return n.updateDiscount()})("ngModelChange",function(u){return n.discount=u}),t.qZA(),t.YNc(20,O,2,0,"span",11),t.qZA()(),t.YNc(21,x,8,3,"div",12),t.YNc(22,k,8,3,"div",12),t.qZA(),t.TgZ(23,"div",13)(24,"h4"),t._uU(25,"Payment Method"),t.qZA(),t.TgZ(26,"form",14)(27,"ul"),t.YNc(28,R,10,8,"li",15),t.qZA()()()(),t.TgZ(29,"div",16)(30,"div",17),t.NdJ("click",function(){return n.processPayment()}),t.TgZ(31,"label"),t._uU(32,"Pay"),t.qZA(),t.TgZ(33,"div",18),t.YNc(34,S,3,3,"ng-container",19),t.YNc(35,F,2,0,"ng-container",19),t.TgZ(36,"span",4),t._uU(37," chevron_right "),t.qZA()()()()()()),2&o&&(t.xp6(14),t.Oqu(n.cartSummary.totalAmount),t.xp6(5),t.Q6J("ngClass",t.VKq(11,U,n.discount>n.cartSummary.totalAmount))("ngModel",n.discount),t.xp6(1),t.Q6J("ngIf",n.discount>n.cartSummary.totalAmount),t.xp6(1),t.Q6J("ngIf",n.discount<=n.cartSummary.totalAmount),t.xp6(1),t.Q6J("ngIf",n.discount>n.cartSummary.totalAmount),t.xp6(4),t.Q6J("formGroup",n.paymentForm),t.xp6(2),t.Q6J("ngForOf",n.paymentMethods),t.xp6(2),t.Q6J("ngClass",t.VKq(13,I,n.paymentForm.invalid||!n.cartList.length||n.discount>n.cartSummary.totalAmount)),t.xp6(4),t.Q6J("ngIf",n.discount<=n.cartSummary.totalAmount),t.xp6(1),t.Q6J("ngIf",n.discount>n.cartSummary.totalAmount))},dependencies:[r.mk,r.sg,r.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.On,a.sg,a.u,r.JJ],styles:['@font-face{font-family:Roboto;src:url(Roboto-Light.f656ed35575e1c0f.eot);src:url(Roboto-Light.f656ed35575e1c0f.eot?#iefix) format("embedded-opentype"),url(Roboto-Light.c1908aa102c46043.woff2) format("woff2"),url(Roboto-Light.8cac82b1a11049d3.woff) format("woff"),url(Roboto-Light.fa832957ce203a1f.ttf) format("truetype"),url(Roboto-Light.34efe5d000a8ca90.svg#Roboto-Light) format("svg");font-weight:300;font-style:normal;font-display:swap}@font-face{font-family:Roboto;src:url(Roboto-Regular.b25cf3301056b4b4.eot);src:url(Roboto-Regular.b25cf3301056b4b4.eot?#iefix) format("embedded-opentype"),url(Roboto-Regular.f4d7b837cc2163cf.woff2) format("woff2"),url(Roboto-Regular.d5a2d8d3d95274b5.woff) format("woff"),url(Roboto-Regular.65fc651f02e5e0ff.ttf) format("truetype"),url(Roboto-Regular.8e2b9e5579cc8e75.svg#Roboto-Regular) format("svg");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Roboto;src:url(Roboto-Medium.8550e2fcd7290684.eot);src:url(Roboto-Medium.8550e2fcd7290684.eot?#iefix) format("embedded-opentype"),url(Roboto-Medium.334eddbab94a4494.woff2) format("woff2"),url(Roboto-Medium.a26c0b28a2d61b9e.woff) format("woff"),url(Roboto-Medium.87ab7dfc46a8c544.ttf) format("truetype"),url(Roboto-Medium.05b3de98db65b636.svg#Roboto-Medium) format("svg");font-weight:500;font-style:normal;font-display:swap}@font-face{font-family:Roboto;src:url(Roboto-Bold.973763fa36dfdd5a.eot);src:url(Roboto-Bold.973763fa36dfdd5a.eot?#iefix) format("embedded-opentype"),url(Roboto-Bold.2a79de665cdad0c3.woff2) format("woff2"),url(Roboto-Bold.363860c7885d8acb.woff) format("woff"),url(Roboto-Bold.6c732b04ad3bda27.ttf) format("truetype"),url(Roboto-Bold.9c350d0784176fe9.svg#Roboto-Bold) format("svg");font-weight:700;font-style:normal;font-display:swap}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%], input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], form[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%]{font-family:Roboto;font-weight:400}button[_ngcontent-%COMP%], input[type*=button][_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-family:Roboto;font-weight:500}.dialog[_ngcontent-%COMP%]{position:fixed;top:0px;left:0px;right:0px;bottom:0px}.retry-payment[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:fixed;top:50%;left:20px;right:20px;background:#ffffff;border-radius:10px;-moz-border-radius:10px;-webkit-border-radius:10px;box-shadow:0 0 30px #0006;-moz-box-shadow:0 0 30px rgba(0,0,0,.4);-webkit-box-shadow:0 0 30px rgba(0,0,0,.4);transform:translateY(-50%);z-index:1001}.retry-payment[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{width:100%;padding:15px 20px;font-size:24px;color:#333;font-weight:500;border-bottom:1px solid #cdcdcd;margin:0}.retry-payment[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#333;line-height:20px;margin:0;width:100%;padding:15px 20px}.retry-payment[_ngcontent-%COMP%]   .dialog-action[_ngcontent-%COMP%]{padding:20px;display:flex;justify-content:space-between}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;top:0px;right:0px;left:0px;bottom:0px;background:rgba(0,0,0,.7);z-index:1000;content:"";display:flex}.checkout-screen[_ngcontent-%COMP%]{background-color:#f0f0f0;min-height:100%;display:flex;flex-direction:column}.checkout-container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;overflow:auto}.checkout-body[_ngcontent-%COMP%]{padding:20px 20px 70px;width:100%;display:flex;flex-direction:column}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]{padding:15px;font-size:18px;background:#ffffff;border-radius:10px;-moz-border-radius:10px;-webkit-border-radius:10px;box-shadow:0 0 15px 2px #7d7d7d33;-moz-box-shadow:0 0 15px 2px rgba(125,125,125,.2);-webkit-box-shadow:0 0 15px 2px rgba(125,125,125,.2);display:flex;flex-wrap:wrap}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item[_ngcontent-%COMP%]{display:flex;margin-bottom:20px;flex-direction:column}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item.half-width[_ngcontent-%COMP%]{width:49%}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:400;margin:0;width:100%;padding-bottom:5px;color:#666}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{color:#333;font-weight:600}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:30px;font-weight:500;margin:0;width:100%}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px;font-weight:400}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item.align-center[_ngcontent-%COMP%]{width:100%;border-top:2px dashed #cdcdcd;padding-top:15px}.checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item.align-center[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .checkout-body[_ngcontent-%COMP%]   .checkout-summery[_ngcontent-%COMP%]   .checkout-summery-item.align-center[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-align:center}.checkout-bottom[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;padding:20px;text-align:center}.checkout-bottom[_ngcontent-%COMP%]   .checkout-btn[_ngcontent-%COMP%]{background:#ff2f00;border-radius:50px;color:#fff;display:flex;justify-content:space-between;align-items:center;padding:15px 20px;box-shadow:0 0 20px #0003;cursor:pointer;font-size:18px}.checkout-bottom[_ngcontent-%COMP%]   .checkout-btn[_ngcontent-%COMP%]   .checkout-btn-right[_ngcontent-%COMP%]{display:flex;align-items:center}.checkout-bottom[_ngcontent-%COMP%]   .checkout-btn.disabled[_ngcontent-%COMP%]{background:#999999;cursor:not-allowed}.payment-method-block[_ngcontent-%COMP%]{display:inline-block;width:100%}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background:#ffffff;box-shadow:0 0 15px 2px #7d7d7d33;margin-bottom:10px;padding:20px;border-radius:10px;cursor:pointer}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .radio-symbol[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid #666666;display:flex;border-radius:100%;-moz-border-radius:100%;-webkit-border-radius:100%;justify-content:center;align-items:center}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .radio-symbol[_ngcontent-%COMP%]   .radio-symbol-inner[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:100%;-moz-border-radius:100%;-webkit-border-radius:100%;background:#666666;display:none}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   .radio-symbol[_ngcontent-%COMP%]   .radio-symbol-inner[_ngcontent-%COMP%]{display:flex}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{padding-right:10px}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px}.payment-method-block[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{margin-top:10px;border-radius:10px;-moz-border-radius:10px;-webkit-border-radius:10px}.checkout-discount[_ngcontent-%COMP%]{width:100%}.checkout-discount[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:40px;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;border-width:1px}.error-highlight[_ngcontent-%COMP%]{background:#d12c2c;padding:3px 10px;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;color:#fff;font-size:14px;width:100%;display:flex;margin-top:5px}']}),e})()}];let J=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.Bz.forChild(N),g.Bz]}),e})(),L=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[r.ez,a.u5,s.Pc,J,a.UX]}),e})()}}]);