"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[755],{755:(I,m,r)=>{r.r(m),r.d(m,{TableModule:()=>J});var d=r(6814),c=r(5548),g=r(3057),v=r(5861),O=r(7394),t=r(6689),x=r(4695),M=r(7535),P=r(5821);const C=function(n){return{occupied:n}};function S(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",7),t.NdJ("click",function(){const l=t.CHM(e).$implicit,i=t.oxw();return t.KtG(i.selectTable(l))}),t.TgZ(1,"div",8)(2,"h3"),t._uU(3),t.qZA(),t.TgZ(4,"h2"),t._uU(5),t.ALo(6,"number"),t.qZA()()()}if(2&n){const e=s.$implicit;t.Q6J("ngClass",t.VKq(5,C,e.total>0)),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.hij("",t.lcZ(6,3,e.total)," frs")}}function y(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){const l=t.CHM(e).$implicit,i=t.oxw(3);return t.KtG(i.selectChairAndNavigate(l,i.selectedTable))}),t.TgZ(1,"h4"),t._uU(2),t.qZA(),t.TgZ(3,"h2"),t._uU(4),t.ALo(5,"number"),t.qZA()()}if(2&n){const e=s.$implicit;t.Q6J("ngClass",t.VKq(5,C,e.total>0)),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.hij("",t.lcZ(5,3,e.total)," frs")}}function Z(n,s){1&n&&(t.TgZ(0,"ion-button",19),t._uU(1," Fully Reserved "),t.qZA())}function w(n,s){if(1&n&&(t.TgZ(0,"ion-content")(1,"div",12)(2,"div",13)(3,"div",14)(4,"h3"),t._uU(5,"Chairs"),t.qZA(),t.TgZ(6,"div",15),t.YNc(7,y,6,7,"div",16),t.qZA()(),t.YNc(8,Z,2,0,"ion-button",17),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(7),t.Q6J("ngForOf",e.selectedTable.chairs),t.xp6(1),t.Q6J("ngIf",e.checkIfAllChairsReserved(e.selectedTable))}}function D(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.closeTableDetails())}),t._UZ(4,"ion-icon",10),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.qZA()()(),t.YNc(7,w,9,2,"ion-content",11)}if(2&n){const e=t.oxw();t.xp6(6),t.hij("Table: ",null==e.selectedTable?null:e.selectedTable.name,""),t.xp6(1),t.Q6J("ngIf",e.selectedTable)}}const k=[{path:"",component:(()=>{class n{constructor(e,o,a,l,i){this.router=e,this.toastController=o,this._user=a,this._account=l,this._global=i,this.apiSubscription=new O.w0,this.runTimeProps=null,this.tableData=null,this.selectedTable=null,this.userDetails=null,this.loadTable=!1}ngOnInit(){}ionViewWillEnter(){const e=this._account.userDetailsObservable.subscribe(a=>{this.userDetails=a});this.apiSubscription.add(e);const o=this._account.runTimePropObservable.subscribe(a=>{if(this.runTimeProps=a,this.runTimeProps.length>0){const l=this.runTimeProps.find(u=>"bid"===u.property_name),i=JSON.parse(localStorage.getItem("tables")||"null");l&&!i?this.getTablesFromServer(l.property_value):(this.tableData=i,this._global.debounce(this.calculateChairTableTotal(),500))}});this.apiSubscription.add(o)}getTablesFromServer(e){this.loadTable=!0;const o=this._user.getTables(e).subscribe(a=>{a.forEach(l=>{l.status="open",l.total=0,l.chairs.forEach(i=>(i.status="open",i.total=0))}),this.tableData=a,localStorage.setItem("tables",JSON.stringify(this.tableData)),this._global.debounce(this.calculateChairTableTotal(),500),setTimeout(()=>{this.loadTable=!1},1e3)});this.apiSubscription.add(o)}getServerCart(){this._user.getAllOrder(this.userDetails.org_id,this.userDetails.branch_id).subscribe(e=>{console.log(e)})}calculateChairTableTotal(){const e=JSON.parse(localStorage.getItem("cart")||"null");console.log(e),this.tableData.forEach(o=>{o.total=0,o.chairs.forEach(a=>{var l,i,u,b,p,h;a.total=0,null!=e&&null!==(l=e[this.userDetails.id])&&void 0!==l&&null!==(i=l[o.uuid])&&void 0!==i&&i[a.uuid]&&Object.keys(null==e||null===(u=e[this.userDetails.id])||void 0===u||null===(b=u[o.uuid])||void 0===b?void 0:b[a.uuid]).length>0&&(Object.keys(null==e||null===(p=e[this.userDetails.id])||void 0===p||null===(h=p[o.uuid])||void 0===h?void 0:h[a.uuid]).forEach(F=>{var f,_;const T=null==e||null===(f=e[this.userDetails.id])||void 0===f||null===(_=f[o.uuid])||void 0===_?void 0:_[a.uuid][F];a.total+=T.quantity*T.unitPrice}),o.total+=a.total)})}),this.getServerCart()}resetToOpenStatus(){this.tableData.forEach(e=>{e.status="open",e.chairs.forEach(o=>o.status="open")}),this.saveTableDataToLocalStorage()}saveTableDataToLocalStorage(){localStorage.setItem("tables",JSON.stringify(this.tableData))}presentToast(e){var o=this;return(0,v.Z)(function*(){(yield o.toastController.create({message:e,duration:2e3,color:"danger"})).present()})()}checkIfAllChairsReserved(e){return e.chairs.every(o=>"reserved"===o.status)}checkIfAnyChairOpen(e){return e.chairs.some(o=>"open"===o.status)}toggleChairStatus(e,o){e.status="open"===e.status?"reserved":"open",console.log(o.chairs),this.checkIfAllChairsReserved(o)?(console.log("All chairs reserved, setting table to reserved."),o.status="reserved"):(console.log("Some chairs are still open, table stays open."),o.status="open"),this.saveTableDataToLocalStorage()}getChairColor(e){return"reserved"===e?"danger":"success"}selectTable(e){this.selectedTable=e}closeTableDetails(){this.selectedTable=null}selectChairAndNavigate(e,o){e.status="reserved",this.saveTableDataToLocalStorage(),localStorage.setItem("selectedTable",JSON.stringify(o)),localStorage.setItem("selectedChair",JSON.stringify(e)),this.router.navigateByUrl("/dashboard").then(()=>{window.location.reload()})}checkIfAnyChairSelected(e){return!1}ngOnDestroy(){this.apiSubscription.unsubscribe()}ionViewWillLeave(){this.apiSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.F0),t.Y36(c.yF),t.Y36(x.K),t.Y36(M.B),t.Y36(P.U))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-table"]],decls:12,vars:2,consts:[["slot","start"],["defaultHref","/dashboard"],[1,"bg-light"],[1,"tables-container"],[1,"table-grid"],["class","table-card",3,"ngClass","click",4,"ngFor","ngForOf"],[3,"isOpen","didDismiss"],[1,"table-card",3,"ngClass","click"],[1,"table-info"],[3,"click"],["name","close-outline"],[4,"ngIf"],[1,"table-details"],[1,"table-details-content"],[1,"chairs-section"],[1,"chair-grid"],["class","chair-block",3,"ngClass","click",4,"ngFor","ngForOf"],["expand","full","disabled","",4,"ngIf"],[1,"chair-block",3,"ngClass","click"],["expand","full","disabled",""]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"Select table"),t.qZA()()(),t.TgZ(6,"ion-content",2)(7,"div",3)(8,"div",4),t.YNc(9,S,7,7,"div",5),t.qZA()(),t.TgZ(10,"ion-modal",6),t.NdJ("didDismiss",function(){return o.closeTableDetails()}),t.YNc(11,D,8,2,"ng-template"),t.qZA()()),2&e&&(t.xp6(9),t.Q6J("ngForOf",o.tableData),t.xp6(1),t.Q6J("isOpen",null!==o.selectedTable))},dependencies:[d.mk,d.sg,d.O5,c.oU,c.YG,c.Sm,c.W2,c.Gu,c.gu,c.wd,c.sr,c.ki,c.cs,d.JJ],styles:[".bg-light[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #f6f8f9 0%, #e5ebee 100%)}.tables-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.table-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px}.table-card[_ngcontent-%COMP%]{background:white;border-radius:10px;box-shadow:0 0 5px #0000001a;overflow:hidden;transition:transform .3s ease,box-shadow .3s ease;cursor:pointer;display:flex;align-items:center;padding:20px;border:1px solid #cdcdcd}.table-card.occupied[_ngcontent-%COMP%]{border-left:7px solid #449d78}.table-card[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 0 20px #00000026}.table-card[_ngcontent-%COMP%]   .table-image[_ngcontent-%COMP%]{width:40%;height:125px;object-fit:cover}.table-card[_ngcontent-%COMP%]   .table-info[_ngcontent-%COMP%]{text-align:center;flex-grow:3;display:flex;justify-content:space-between;flex-wrap:wrap;align-items:center}.table-card[_ngcontent-%COMP%]   .table-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:700;color:#2c3e50;text-align:left}.table-card[_ngcontent-%COMP%]   .table-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;color:#333;margin:0;font-weight:300}.table-card[_ngcontent-%COMP%]   .table-info[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-block;padding:5px 10px;border-radius:20px;font-weight:700;text-transform:uppercase}.table-card[_ngcontent-%COMP%]   .table-info[_ngcontent-%COMP%]   .badge-open[_ngcontent-%COMP%]{background-color:#2ecc71;color:#fff}.table-card[_ngcontent-%COMP%]   .table-info[_ngcontent-%COMP%]   .badge-reserved[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff}.table-details[_ngcontent-%COMP%]   .detail-image[_ngcontent-%COMP%]{width:100%;max-height:280px;object-fit:cover}.table-details[_ngcontent-%COMP%]   .table-details-content[_ngcontent-%COMP%]{padding:20px}.table-details[_ngcontent-%COMP%]   .table-details-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin:0}.table-details[_ngcontent-%COMP%]   .table-details-content[_ngcontent-%COMP%]   .chairs-section[_ngcontent-%COMP%]{margin-top:20px}.table-details[_ngcontent-%COMP%]   .table-details-content[_ngcontent-%COMP%]   .chair-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:10px}.table-details[_ngcontent-%COMP%]   .disabled-button[_ngcontent-%COMP%]{--background: #b0bec5;--color: white}.table-details[_ngcontent-%COMP%]   ion-button[disabled][_ngcontent-%COMP%]{--background: #b0bec5;--color: white;cursor:not-allowed}.chair-block[_ngcontent-%COMP%]{width:100%;padding:20px;border:1px solid #cdcdcd;box-shadow:0 0 5px #0003;background:#ffffff;border-radius:10px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease}.chair-block.occupied[_ngcontent-%COMP%]{border-left:7px solid #449d78}.chair-block[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 0 15px #0003}.chair-block[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px;color:#333;margin:0;font-weight:500}.chair-block[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;color:#333;margin:0;font-weight:300}"]}),n})()}];let A=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.Bz.forChild(k),g.Bz]}),n})(),J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,c.Pc,A]}),n})()}}]);