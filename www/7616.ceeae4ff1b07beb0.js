"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7616],{7616:(E,b,r)=>{r.r(b),r.d(b,{ReceiptPageModule:()=>B});var g=r(6814),_=r(95),u=r(5548),d=r(3057),C=r(7055),y=r(7394),M=r(6676),t=r(6689),O=r(4695),x=r(2425),v=r(5821),R=r(7535),w=r(5861);const i=(0,r(2726).fo)("SunmiPlugin");let Z=(()=>{class o{constructor(e){this.decimalPipe=e}fillSpace(e,n){const a=" ".repeat(29-e.length);return"right"===n?a+e:e+a}breakWords(e,n){return e.match(/.{1,29}/g).map(p=>p.length<29?this.fillSpace(p,n):p).join("")}dashedBorder(){return"-----------------------------"}formatLines(e,n="left"){return e.length>29?this.breakWords(e,n):this.fillSpace(e,n)}addEmptyLine(){return"                             "}formatColumn2(e,n){const c=e.length,a=n.length;return c+" ".repeat(29-(c+a))+a}printProducts(e){return new Promise((n,c)=>{e.cartList.forEach(a=>{i.text({text:this.formatLines(`${a.name} X ${a.quantity}`)}),i.text({text:this.formatLines(`${this.decimalPipe.transform(a.unitPrice)}`,"right")})}),n(!0)})}print(e){var n=this;return(0,w.Z)(function*(){yield i.start(),yield i.align({direction:"LEFT"}),yield i.bold(),yield i.text({text:n.formatLines(e.ownerInfo.Name)}),yield i.normal(),yield i.text({text:n.formatLines(e.ownerInfo.Slogan)}),yield i.text({text:n.formatLines(e.ownerInfo.Location)}),yield i.text({text:n.formatLines(`Tel: ${e.ownerInfo.Tel}`)}),yield i.text({text:n.dashedBorder()}),yield i.text({text:n.formatLines(`Agent: ${e.userDetails.first_name} ${e.userDetails.last_name}`)}),yield i.text({text:n.formatLines("Order Type: SALE")}),yield i.text({text:n.formatLines(`Payment Method: ${e.paymentData.method}`)}),"CASH"!==e.paymentData.method&&(yield i.text({text:n.formatLines(`Account: ${e.paymentData.value}`)})),yield i.text({text:n.addEmptyLine()}),yield i.text({text:n.formatLines("Product List")}),yield i.text({text:n.dashedBorder()}),yield n.printProducts(e),yield i.text({text:n.dashedBorder()}),yield i.text({text:n.formatLines(`Subtotal: ${n.decimalPipe.transform(e.cartSummary.totalAmount)} frs`,"right")}),yield i.text({text:n.formatLines(`Discount: -${n.decimalPipe.transform(e.paymentData.discount)} frs`,"right")}),yield i.text({text:n.formatLines(`Total: ${n.decimalPipe.transform(e.cartSummary.totalAmount-e.paymentData.discount)} frs`,"right")}),yield i.text({text:n.addEmptyLine()}),yield i.text({text:n.formatLines("Thank you for shopping with")}),yield i.text({text:n.formatLines("us")}),yield i.text({text:n.formatLines("$www.balaanz.com")}),yield i.text({text:n.addEmptyLine()}),yield i.text({text:n.addEmptyLine()}),yield i.text({text:n.addEmptyLine()}),yield i.text({text:n.formatLines("www.balaanz.com")}),yield i.print()})()}ngOnDestroy(){}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(g.JJ))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function L(o,s){if(1&o&&(t.TgZ(0,"li")(1,"label"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA(),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"number"),t.qZA()()),2&o){const e=s.$implicit;t.xp6(2),t.hij(" ",e.name," "),t.xp6(2),t.hij(" X ",e.quantity," "),t.xp6(2),t.hij(" ",t.lcZ(7,3,e.unitPrice)," frs ")}}function S(o,s){if(1&o&&(t.TgZ(0,"h4",20)(1,"label"),t._uU(2,"Discount:"),t.qZA(),t.TgZ(3,"b"),t._uU(4),t.ALo(5,"number"),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(4),t.hij("-",t.lcZ(5,1,e.paymentData.discount)," frs")}}function A(o,s){if(1&o&&(t.TgZ(0,"div",17)(1,"ul"),t.YNc(2,L,8,5,"li",18),t.qZA(),t.TgZ(3,"div",19)(4,"h4",20)(5,"label"),t._uU(6,"Subtotal:"),t.qZA(),t.TgZ(7,"b"),t._uU(8),t.ALo(9,"number"),t.qZA()()(),t.TgZ(10,"div",21),t.YNc(11,S,6,3,"h4",22),t.qZA(),t.TgZ(12,"div",19)(13,"h4")(14,"label"),t._uU(15,"Total:"),t.qZA(),t.TgZ(16,"b"),t._uU(17),t.ALo(18,"number"),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.receiptCartList),t.xp6(6),t.hij("",t.lcZ(9,4,e.receiptCartSummary.totalAmount)," frs"),t.xp6(3),t.Q6J("ngIf",e.paymentData.discount>0),t.xp6(6),t.hij("",t.lcZ(18,6,e.receiptCartSummary.totalAmount-e.paymentData.discount)," frs")}}const D=[{path:"",component:(()=>{class o{constructor(e,n,c,a,p,f,k,Y,q){this._nav=e,this._user=n,this._toastr=c,this._global=a,this._platform=p,this._route=f,this._account=k,this._sunmi=Y,this._actRoute=q,this.userDetails=null,this.cartList=[],this.runTimeProps=null,this.cartSummary={},this.apiSubscription=new y.w0,this.currentDate=M().format("DD/MMM/YYYY HH:mm:ss"),this.receiptCartList=[],this.receiptCartSummary=[],this.requestId=null,this.paymentData=this._global.getPaymentData(),this.businessName="",this.telephone="",this._platform.backButton.subscribeWithPriority(-1,()=>{this._route.url&&this._route.url.search("dashboard")>0&&localStorage.getItem("token")&&C.g.exitApp()}),this.requestId=this._actRoute.snapshot.params.requestId,this._account.userDetailsObservable.subscribe(l=>{this.userDetails=l,this._global.initCart(this.userDetails.id),this.cartList=this._global.retriveCart(this.userDetails.id).list,this.cartSummary=this._global.getCartSummary()}),this._account.runTimePropObservable.subscribe(l=>{this.runTimeProps=l}),this._account.runTimePropObservable.subscribe(l=>{this.runTimeProps=l;const m=l.find(P=>"Business Name"===P.property_name);this.businessName=(null==m?void 0:m.property_value)||"";const h=l.find(P=>"telephone1"===P.property_name);this.telephone=(null==h?void 0:h.property_value)||""})}ngOnInit(){}clearCart(){this.cartList.length?(this._toastr.success("Payment has been successfully done.","Payment Successful"),this.receiptCartList=[...this.cartList],this.receiptCartSummary={...this.cartSummary},this._global.emptyCart(this.userDetails.id)):this._nav.navigateBack("dashboard")}ionViewWillEnter(){this._global.setServerErr(!1),this.apiSubscription=new y.w0,this.clearCart(),this._account.runTimePropObservable.subscribe(e=>{console.log("Runtime Props Received:",e),this.runTimeProps=e})}ionViewWillLeave(){this.apiSubscription.unsubscribe(),this._global.setServerErr(!1)}back(){this._global.setServerErr(!1),this._nav.navigateBack("dashboard")}printReceipt(){this._sunmi.print({ownerInfo:{Name:this.runTimeProps[0].property_value,Location:this.runTimeProps[3].property_value,Tel:this.telephone,Slogan:this.runTimeProps[2].property_value},cartList:this.receiptCartList,cartSummary:this.receiptCartSummary,currentDate:this.currentDate,userDetails:this.userDetails,paymentData:this.paymentData}),this._nav.navigateBack("dashboard")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.SH),t.Y36(O.K),t.Y36(x._W),t.Y36(v.U),t.Y36(u.t4),t.Y36(d.F0),t.Y36(R.B),t.Y36(Z),t.Y36(d.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-receipt"]],decls:48,vars:9,consts:[[1,"receipt-screen"],[1,"receipt-container"],[1,"app-header"],[1,"back-page",3,"click"],[1,"material-symbols-outlined"],[1,"app-page-title"],[1,"receipt-body"],[1,"receipt-page"],[1,"receipt-title"],[1,"receipt-header","text-center","mb-4"],[1,"text-sm"],[1,"receipt-header"],["class","receipt-products",4,"ngIf"],[1,"receipt-footer"],[1,"receipt-bottom"],[1,"receipt-btn",3,"click"],[1,"receipt-btn-right"],[1,"receipt-products"],[4,"ngFor","ngForOf"],[1,"receipt-product-summary"],[1,"light-line"],[1,"receipt-product-summary",2,"color","green"],["class","light-line",4,"ngIf"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.NdJ("click",function(){return n.back()}),t.TgZ(4,"span",4),t._uU(5," close "),t.qZA()(),t.TgZ(6,"div",5),t._uU(7," Receipt "),t.qZA()(),t.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"h2"),t._uU(12),t.qZA(),t.TgZ(13,"p"),t._uU(14),t.qZA(),t.TgZ(15,"h2")(16,"div",9)(17,"p",10),t._uU(18),t.qZA()()()(),t.TgZ(19,"div",11),t._UZ(20,"p"),t.TgZ(21,"p"),t._uU(22,"Agent: "),t.TgZ(23,"span"),t._uU(24),t.qZA()(),t.TgZ(25,"p"),t._uU(26,"Type: "),t.TgZ(27,"span"),t._uU(28,"SALE"),t.qZA()(),t.TgZ(29,"p"),t._uU(30,"Payment Method: "),t.TgZ(31,"span"),t._uU(32),t.qZA()(),t.TgZ(33,"p"),t._uU(34,"Order Date: "),t.TgZ(35,"span"),t._uU(36),t.qZA()()(),t.YNc(37,A,19,8,"div",12),t.TgZ(38,"div",13)(39,"p"),t._uU(40,"Thank you for shopping with us"),t.qZA()()()(),t.TgZ(41,"div",14)(42,"div",15),t.NdJ("click",function(){return n.printReceipt()}),t.TgZ(43,"label"),t._uU(44,"Print Receipt"),t.qZA(),t.TgZ(45,"div",16)(46,"span",4),t._uU(47," print "),t.qZA()()()()()()),2&e&&(t.xp6(12),t.Oqu(n.runTimeProps[0].property_value),t.xp6(2),t.Oqu(n.runTimeProps[3].property_value),t.xp6(4),t.hij("Tel: ",n.telephone,""),t.xp6(6),t.AsE("",n.userDetails.first_name," ",n.userDetails.last_name,""),t.xp6(8),t.AsE("",n.paymentData.method," ",n.paymentData.value,""),t.xp6(4),t.Oqu(n.currentDate),t.xp6(1),t.Q6J("ngIf",n.receiptCartList.length))},dependencies:[g.sg,g.O5,g.JJ],styles:['@font-face{font-family:Roboto;src:url(Roboto-Light.f656ed35575e1c0f.eot);src:url(Roboto-Light.f656ed35575e1c0f.eot?#iefix) format("embedded-opentype"),url(Roboto-Light.c1908aa102c46043.woff2) format("woff2"),url(Roboto-Light.8cac82b1a11049d3.woff) format("woff"),url(Roboto-Light.fa832957ce203a1f.ttf) format("truetype"),url(Roboto-Light.34efe5d000a8ca90.svg#Roboto-Light) format("svg");font-weight:300;font-style:normal;font-display:swap}@font-face{font-family:Roboto;src:url(Roboto-Regular.b25cf3301056b4b4.eot);src:url(Roboto-Regular.b25cf3301056b4b4.eot?#iefix) format("embedded-opentype"),url(Roboto-Regular.f4d7b837cc2163cf.woff2) format("woff2"),url(Roboto-Regular.d5a2d8d3d95274b5.woff) format("woff"),url(Roboto-Regular.65fc651f02e5e0ff.ttf) format("truetype"),url(Roboto-Regular.8e2b9e5579cc8e75.svg#Roboto-Regular) format("svg");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Roboto;src:url(Roboto-Medium.8550e2fcd7290684.eot);src:url(Roboto-Medium.8550e2fcd7290684.eot?#iefix) format("embedded-opentype"),url(Roboto-Medium.334eddbab94a4494.woff2) format("woff2"),url(Roboto-Medium.a26c0b28a2d61b9e.woff) format("woff"),url(Roboto-Medium.87ab7dfc46a8c544.ttf) format("truetype"),url(Roboto-Medium.05b3de98db65b636.svg#Roboto-Medium) format("svg");font-weight:500;font-style:normal;font-display:swap}@font-face{font-family:Roboto;src:url(Roboto-Bold.973763fa36dfdd5a.eot);src:url(Roboto-Bold.973763fa36dfdd5a.eot?#iefix) format("embedded-opentype"),url(Roboto-Bold.2a79de665cdad0c3.woff2) format("woff2"),url(Roboto-Bold.363860c7885d8acb.woff) format("woff"),url(Roboto-Bold.6c732b04ad3bda27.ttf) format("truetype"),url(Roboto-Bold.9c350d0784176fe9.svg#Roboto-Bold) format("svg");font-weight:700;font-style:normal;font-display:swap}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%], input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], form[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%]{font-family:Roboto;font-weight:400}button[_ngcontent-%COMP%], input[type*=button][_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-family:Roboto;font-weight:500}.receipt-screen[_ngcontent-%COMP%]{background-color:#f0f0f0;min-height:100%}.receipt-body[_ngcontent-%COMP%]{padding:20px 20px 70px;width:100%}.receipt-bottom[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;padding:20px;text-align:center}.receipt-bottom[_ngcontent-%COMP%]   .receipt-btn[_ngcontent-%COMP%]{background:#ff2f00;border-radius:50px;color:#fff;display:flex;justify-content:space-between;align-items:center;padding:15px 20px;box-shadow:0 0 20px #0003;cursor:pointer;font-size:18px}.receipt-bottom[_ngcontent-%COMP%]   .receipt-btn[_ngcontent-%COMP%]   .receipt-btn-right[_ngcontent-%COMP%]{display:flex;align-items:center}.receipt-bottom[_ngcontent-%COMP%]   .receipt-btn.disabled[_ngcontent-%COMP%]{background:#999999;cursor:not-allowed}.receipt-page[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.receipt-page[_ngcontent-%COMP%]   .receipt-title[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center}.receipt-page[_ngcontent-%COMP%]   .receipt-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;padding:0 0 5px}.receipt-page[_ngcontent-%COMP%]   .receipt-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:2px 0;margin:0}.receipt-page[_ngcontent-%COMP%]   .receipt-header[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;border-bottom:1px dashed #000000;padding:20px 0}.receipt-page[_ngcontent-%COMP%]   .receipt-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:0;padding:2px 0;line-height:24px}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]{width:100%;display:flex;padding:20px 0;flex-direction:column}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;width:100%;display:flex;flex-direction:column;padding:0 0 10px;margin:0;border-bottom:1px dashed #000000}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100%;display:flex;padding-bottom:10px}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:50%}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:20%;text-align:right}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{width:30%;text-align:right}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;padding-top:10px}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;width:100%;display:flex;padding:2px 0;line-height:24px}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:70%;text-align:right}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{width:30%;text-align:right}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;padding:2px 0;width:100%;display:flex}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:70%;text-align:right}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{width:30%;text-align:right}.receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   h4.light-line[_ngcontent-%COMP%], .receipt-page[_ngcontent-%COMP%]   .receipt-products[_ngcontent-%COMP%]   .receipt-product-summary[_ngcontent-%COMP%]   h4.light-line[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-weight:400}.receipt-page[_ngcontent-%COMP%]   .receipt-footer[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.receipt-page[_ngcontent-%COMP%]   .receipt-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}']}),o})()}];let U=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[d.Bz.forChild(D),d.Bz]}),o})(),B=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,_.u5,u.Pc,U]}),o})()}}]);